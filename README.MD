# DBML parser for Go

DBML-go is a Go parser for [DBML](https://www.dbml.org) syntax.

## Installation

Go get

```bash
go get github.com/duythinht/dbml-go/...
```

## Quick start

```go
package main

import (
	"fmt"
	"os"

	"github.com/duythinht/dbml-go/parser"
	"github.com/duythinht/dbml-go/scanner"
)

func main() {
	f, _ := os.Open("test.dbml")
	s := scanner.NewScanner(f)
	parser := parser.NewParser(s)
	dbml, err := parser.Parse()
	if err != nil {
        fmt.Printf("%s\n", err)
        os.Exit(1)
    }

    // process dbml here
}
```

## Go model generate

```bash
go get github.com/duythinht/dbml-go/cmd/dbml-go-gen-model
```

```
Usage:
  dbml-gen-go-model [flags]

Flags:
  -f, --from string      source of dbml, can be https://dbdiagram.io/... | file_name.dbml (default "database.dbml")
  -h, --help             help for dbml-gen-go-model
  -o, --out string       output folder (default "model")
  -p, --package string   single for multiple files (default "model")
```

#### Example:

input:

```dbml
// database.dbml
Table users as U {
  id int [pk, unique, increment] // auto-increment
  full_name varchar [not null, unique, default: 1]
  created_at timestamp
  country_code int
  Note: 'khong hieu duoc'
}
```

output: users.table.go

```go
// Code generated by dbml-gen-go-model. DO NOT EDIT.
// Supported by duythinht@2020
package model

// User is generated type for table 'users'
type User struct {
	ID          int    `db:"id" json:"id" mapstructure:"id"`
	FullName    string `db:"full_name" json:"full_name" mapstructure:"full_name"`
	CreatedAt   int    `db:"created_at" json:"created_at" mapstructure:"created_at"`
	CountryCode int    `db:"country_code" json:"country_code" mapstructure:"country_code"`
}

// table 'users' metadata Structure
type __tbl_users struct {
	ID          string
	FullName    string
	CreatedAt   string
	CountryCode string
}

// table 'users' metadata info
var _tbl_users = __tbl_users{
	CountryCode: "country_code",
	CreatedAt:   "created_at",
	FullName:    "full_name",
	ID:          "id",
}

// Columns return list columns's name for table 'users'
func (*__tbl_users) Columns() []string {
	return []string{"id", "full_name", "created_at", "country_code"}
}

// DataColumns return list columns's name for table 'users' except 'id' columns
func (*__tbl_users) DataColumns() []string {
	return []string{"full_name", "created_at", "country_code"}
}

// String return name of table 'users'
func (*__tbl_users) String() string {
	return "users"
}

// TBL return metadata info for table 'users'
func (*User) TBL() *__tbl_users {
	return &_tbl_users
}

```
